<form #formCheck="ngForm">
  <mat-card>
    <mat-card-content>
      <div>{{ "ShareYourOwnTrip" | translate }}</div>
      <div>1 {{ "SelectAPhoto" | translate }}</div>
      <div>
        <input
          type="file"
          multiple="multiple"
          style="display: none"
          #fileInput
          accept="image/*"
          (change)="onClickSelectPhoto()" />
        <button type="button" (click)="onClickSelectPhotoInputButton()">写真を選択</button>
      </div>
      <ng-container *ngIf="row">
        <div *ngFor="let item of row.planSpots; index as i;trackBy: myTrackBy">
          <span>{{ item.displayOrder }}</span>
          <mat-form-field appearance="outline" style="width: 100px;">
          <input
            type="time"
            matInput
            #startTime
            name="startTime{{i}}"
            maxlength="5"
            placeholder="{{ 'startTimeEx' | translate }}" 
            required 
            #inputinfo="ngModel" 
            [(ngModel)]="item.startTime"
            (change)="onChangeStartTime()" />
          </mat-form-field>
          <span *ngIf="!item.spotName">{{ 'RegisterSpot' | translate }}</span>
          <span *ngIf="item.spotName">{{ item.spotName }}</span>
          <button type="button" mat-button (click)="onClickSpotSelect(item)"><i class="material-icons">location_on</i></button>
          <button type="button" mat-button (click)="onClickSpotDelete(item)"><i class="material-icons">close</i></button>
          <img width="100%" height="100%" [src]="item.planUserpictures[0].picturePreviewUrl ? item.planUserpictures[0].picturePreviewUrl : item.planUserpictures[0].picture_url" />
          <mat-form-field hintLabel="Max 100 characters" appearance="outline" style="width: 100%;">
            <textarea 
              matInput 
              #memo
              name="memo{{i}}" 
              maxlength="100"
              placeholder="{{ 'MemoEx' | translate }}" 
              #inputinfo="ngModel" 
              [(ngModel)]="item.memo"></textarea>
            <mat-hint align="end">{{memo.value?.length || 0}}/100{{ "Characters" | translate }}</mat-hint>
          </mat-form-field>
          <div *ngFor="let video of item.planUserpictures; index as i;trackBy: myTrackBy">
            <ng-container *ngIf="video.is_video" >
              <video [src]="(video.picturePreviewUrl ? video.picturePreviewUrl : video.picture_url) | safeUrl" controls></video>
              <button type="button" mat-button (click)="onClickVideoDelete(item, video)"><i class="material-icons">close</i></button>
            </ng-container>
          </div>
          <input
            type="file"
            multiple="multiple"
            style="display: none"
            #videoInput
            accept="video/*"
            (change)="onClickSelectVideo(item)" />
          <button type="button" (click)="onClickSelectVideoInputButton()">動画を選択</button>       
        </div>
      </ng-container>
      <div>2 {{ "EnterThePlanName" | translate }}</div>
        <mat-list>
          <mat-list-item style="height: 100px;">
            <mat-form-field hintLabel="Max 20 characters" appearance="outline" style="width: 100%;">
              <input 
                matInput 
                #planName
                name="planName"
                maxlength="20"
                placeholder="{{ 'PlanNameEx' | translate }}" 
                required 
                #inputinfo="ngModel" 
                [(ngModel)]="row.planName" />
            <mat-hint align="end">{{planName.value?.length || 0}}/20{{ "Characters" | translate }}</mat-hint>
          </mat-form-field>  
        </mat-list-item>
        <mat-list-item style="height: 100px;">
          <mat-form-field hintLabel="Max 100 characters" appearance="outline" style="width: 100%;">
            <textarea 
              matInput 
              #planExplanation
              name="planExplanation" 
              maxlength="100"
              placeholder="{{ 'PlanExplanationEx' | translate }}" 
              #inputinfo="ngModel" 
              [(ngModel)]="row.planExplanation"></textarea>
            <mat-hint align="end">{{planExplanation.value?.length || 0}}/100{{ "Characters" | translate }}</mat-hint>
          </mat-form-field>
        </mat-list-item>
        <mat-list-item style="height: 100px;">
          <mat-form-field hintLabel="Max 100 characters" appearance="outline" style="width: 100%;">
            <textarea 
              matInput 
              #freeMemo
              name="freeMemo" 
              maxlength="100"
              placeholder="{{ 'FreeMemoEx' | translate }}" 
              #inputinfo="ngModel" 
              [(ngModel)]="row.memo"></textarea>
            <mat-hint align="end">{{freeMemo.value?.length || 0}}/100{{ "Characters" | translate }}</mat-hint>
          </mat-form-field>
        </mat-list-item>
      </mat-list>
      <div>3 {{ "SelectAnAreaCategory" | translate }}</div>
      <button (click)="onClickAreaCategory()">
        {{ "AreaAndCommitment" | translate }}
      </button>
      <mat-card-content>
        <mat-chip-list>
          <mat-chip *ngFor="let item of optionKeywords">
            {{ item }}
          </mat-chip>
        </mat-chip-list>
      </mat-card-content>
      <div>4 {{ "ShareYourPlanWithOtherUsers" | translate }}</div>
        <mat-radio-group name="isRelease" [(ngModel)]="row.isRelease">
          <mat-radio-button [value]="true">{{ "Release" | translate }}</mat-radio-button>
          <mat-radio-button [value]="false">{{ "Private" | translate }}</mat-radio-button>
        </mat-radio-group>
    </mat-card-content>
  </mat-card>

  <button *ngIf="row.isRelease"
    (click)="onClickSave()"
    [disabled]="formCheck.invalid">
    {{ "Save" | translate }}
  </button>
  <button *ngIf="!row.isRelease"
    (click)="onClickSave()"
    [disabled]="formCheck.invalid">
    {{ "SaveDraft" | translate }}
  </button>
</form>
<agm-map #map></agm-map>